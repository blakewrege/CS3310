import java.io.IOException;

public class CustomerPQ {
	private int N;
	private final int maxN=200;
	private HeapNode[] heap;
	private int initialPriorityValue = 100;
	private int priorityValue;
	
	public CustomerPQ(UIoutput output)
	{
		heap = new HeapNode[maxN];
		N = 0;
		
	}
	
	
	public void insert(int count, String theLine, UIoutput output) throws IOException{
		//output.displayThis(theLine+" \n");
		String fields[] = theLine.split(",");
		for (int i = 0; i < fields.length; i++) {
		//	fields[i] = info[i+1];

		}
		//System.out.print(fields[0]);
		//System.out.println(" Length: "+fields.length);
		determinePriorityValue(fields);
		//System.out.println(""+priorityValue);
		output.displayThis("ADDED: "+fields[0]+" ("+priorityValue+")"); 
		heapInsert(fields[0], priorityValue);
		
	}
	
	
	private void heapInsert(String value, int pv)
	{
		HeapNode newNode = new HeapNode(value, pv);
		
		heap[N] = newNode;
		N++;
		
		walkUp(N-1);
		
	}
	
	private void walkUp(int i)
	{
		
		HeapNode temp=heap[i];
		while(i > 0 && temp.getPriorityValue() < heap[(i-1)/2].getPriorityValue())
		{
		
				heap[i] = heap[(i-1)/2];
				i = (i-1)/2;
			
		}
		heap[i] = temp;
	}
	
	
	
	private void determinePriorityValue(String[] points) throws IOException
	{
		int age = new Integer(points[points.length-1]);
		priorityValue = ++initialPriorityValue;
		
		
		for(int i = 1; i<points.length-1;i++)
		{
			switch (points[i].toLowerCase()) 
			{
				case "employee":
					priorityValue-=10;
					break;
				case "owner":
					priorityValue-=(50+10);
					break;
				case "vip":
					priorityValue-=5;
					break;
				case "supervip":
					priorityValue-=(8+5);
					break;
				case "loyalty":
					priorityValue-=4;
					break;
				case "child":
					priorityValue-=2;
					break;
				
			}
		}
		if(age >= 65)
		{
			priorityValue-= 5;
			
		}
		
		if(age >=80)
		{
			priorityValue-= 5;
		}

	}
	
	
	
	
	
	
	

}
